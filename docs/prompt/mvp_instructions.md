# MVP指示書

本ドキュメントは、仕入明細書管理機能を中心とした最小限(MVP)の実装方針を示すために作成したものです。  
大規模運用向けの拡張機能は一切含まず、まずは動くものを早期に完成させることを目的とします。

---

## 1. 対象機能

1. **ユーザー管理（認証）**

   - メールアドレス/パスワードでログイン、ログアウトするだけ。
   - ロール分けは「一般ユーザー(または外部ユーザー)」「管理者」程度に最低限。
   - セッションのレート制限や上限管理といった複雑な要件は除外する。

2. **取引先管理 (Vendor)**

   - シンプルなCRUD機能（一覧、登録、編集、削除）。
   - タグ機能も最小限でOK（タグ1～2個つけられる程度）。
   - フィルタリングや大量ページネーションは後回し。

3. **仕入明細書管理 (Invoice)**
   - 仕入明細書の新規作成、編集、PDF出力ができること。
   - 仕入明細書のステータス管理 (下書き/承認済み の切り替え程度)。
   - 外部ユーザーが自身の仕入明細書を作成→提出できるようにする。
   - 大量データ・複雑な税制対応は後回し。

---

## 2. 割り切りと除外内容

- サーバー負荷や高可用性を想定した構成は行わない。
- Redisなどのセッション管理は不要か、必要最小限にとどめる。
- CIでの高度な並列実行やレート制限の実装は当面スコープ外。
- 認証リトライの制限(DoS対策)などのセキュリティ機能は簡易に済ませる。
- 「OCR/解析で外部PDFを取り込む」などの高度機能も今回は対象外。

---

## 3. テスト方針 (Cypress)

1. **主要フローのE2Eテスト**
   - ログイン → ダッシュボード表示 → 仕入明細書作成 → PDF出力を最優先で確認。
   - 取引先管理のCRUDをひと通りテスト（登録→編集→削除）。

2. **セットアップ**
   - 開発環境 (DBなど) は手動でクリーンにしてからテストする。
   - シンプルなCIパイプラインが組めれば十分。詳細な並列化は後で検討する。

3. **必要最小限のテストケース**
   - バリデーションエラー(必須項目の空チェックなど)。
   - PDFを正常にダウンロードできるか。
   - ロールによる操作権限の簡易確認(一般ユーザーと管理者)。

---

## 4. タスク・スケジュール

1. **ユーザー管理**
   - 1日: 認証APIとログイン画面の実装 + 簡単なE2Eテスト。

2. **取引先管理**
   - 1-2日: CRUD画面+テスト(タグ付けも最低限)。

3. **仕入明細書管理**
   - 2日: 作成画面、PDF出力、ステータス更新を実装。
   - 1日: E2Eテストと手動検証(ハッピーパス中心)。

合計: 5～6日を目安にMVPを完成させる。

---

## 5. 運用・リリース方針

- MVP実装が完了次第、ステージングもしくは小規模環境で実際に動かす。
- 重大なバグがなければクライアントへデモ・リリース。
- 追加要望（大量データ対応、複雑なセッション管理など）はMVP稼働後に拡張検討。

---

以上が、本プロジェクトのMVPを構築するための最低限の指針です。  
まずはこの計画でシンプルに開発を進め、動く仕入明細書管理システムを作り上げましょう。
